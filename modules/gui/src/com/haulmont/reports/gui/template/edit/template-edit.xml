<!--
  ~ Copyright (c) 2008-2016 Haulmont. All rights reserved.
  ~ Use is subject to license terms, see http://www.cuba-platform.com/commercial-software-license for details.
  -->

<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        class="com.haulmont.reports.gui.template.edit.TemplateEditor"
        datasource="templateDs"
        caption="msg://templateEditor"
        messagesPack="com.haulmont.reports.gui"
        focusComponent="code">

    <dsContext>
        <datasource
                id="templateDs"
                class="com.haulmont.reports.entity.ReportTemplate"
                view="template.edit"
                datasourceClass="com.haulmont.reports.gui.datasource.NotPersistenceDatasource"/>
    </dsContext>

    <assign name="width" value="500px"/>

    <layout spacing="true">
        <hbox id="createTemplateFields" width="100%" expand="chartPreviewBox">
            <vbox spacing="true" width="AUTO">
                <grid spacing="true">
                    <columns>
                        <column/>
                        <column flex="1"/>
                    </columns>
                    <rows>
                        <row>
                            <label value="msg://template.code" align="MIDDLE_LEFT"/>
                            <textField id="code" datasource="templateDs" property="code"
                                       width="${width}" required="true"
                                       requiredMessage="msg://template.codeMsg"/>
                        </row>
                        <row>
                            <label id="templateFileLabel" value="msg://template.file" align="MIDDLE_LEFT"/>
                            <upload id="templateUploadField" dropZone="createTemplateFields" width="${width}" showFileName="true"/>
                        </row>
                        <row>
                            <sourceCodeEditor id="templateFileEditor" width="100%" height="350"
                                              highlightActiveLine="true"
                                              printMargin="true"
                                              showGutter="true" colspan="2"/>
                        </row>
                        <row>
                            <label value="msg://template.outputType" align="MIDDLE_LEFT"/>
                            <lookupField id="outputType" datasource="templateDs"
                                         textInputAllowed="false"
                                         nullOptionVisible="true"
                                         property="reportOutputType"
                                         width="${width}" required="true"
                                         requiredMessage="msg://template.outputTypeMsg"/>
                        </row>
                        <row>
                            <label id="outputNamePatternLabel" value="msg://template.outputNamePattern" align="MIDDLE_LEFT"/>
                            <textField id="outputNamePattern" datasource="templateDs" property="outputNamePattern"
                                       width="${width}">
                                <validator
                                        class="com.haulmont.reports.gui.report.validators.OutputFileNameValidator"/>
                            </textField>
                        </row>
                        <row>
                            <label value="msg://template.isCustom" align="MIDDLE_LEFT"/>
                            <checkBox id="custom" datasource="templateDs" property="custom"
                                      width="${width}"/>
                        </row>
                        <row>
                            <label value="msg://template.isAlterableOutput" align="MIDDLE_LEFT"/>
                            <checkBox id="alterable" datasource="templateDs" property="alterable"
                                      width="${width}"/>
                        </row>
                        <row>
                            <label id="customDefinedByLabel" value="msg://template.customDefinedBy" align="MIDDLE_LEFT"/>
                            <lookupField id="customDefinedBy" datasource="templateDs" property="customDefinedBy"
                                         width="${width}"/>
                        </row>
                        <row>
                            <label id="customDefinitionLabel" value="msg://template.customDefinition" align="MIDDLE_LEFT"/>
                            <textField id="customDefinition" datasource="templateDs" property="customDefinition"
                                       width="${width}"/>
                        </row>
                    </rows>
                </grid>
                <hbox id="chartEditBox" visible="false">
                    <frame id="chartEdit" screen="chartEdit" width="AUTO"/>
                </hbox>
            </vbox>
            <vbox id="chartPreviewBox" visible="false">

            </vbox>
        </hbox>

        <frame id="windowActions" screen="editWindowActions" width="AUTO"/>
    </layout>
</window>